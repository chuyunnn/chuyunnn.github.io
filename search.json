[{"title":"Diffusion over 隐式神经表示INR","url":"/papers/work2/Diffusion-over-%E9%9A%90%E5%BC%8F%E7%A5%9E%E7%BB%8F%E8%A1%A8%E7%A4%BAINR/","content":"问题表述使用**神经网络表示函数$\\phi(x)$**。\n\n$\\phi(x)$：学习一个函数本身，这个函数必须满足某些物理&#x2F;几何数学约束（方程）\n\n约束：$\\phi$以及它的导数必须满足某个条件C&#x3D;0 &#x3D;&#x3D;&gt; 隐式问题表述\n\n\n$\\nabla \\phi(x)&#x3D;f(x)$ –&gt; $C(x, \\phi, \\nabla\\phi, \\nabla^2\\phi) &#x3D; \\nabla^2\\phi - f(x) &#x3D; 0.$\n其中x表示坐标，$\\phi(x)$为RSS，C为规则检查器。C&#x3D;0时才算合法。这里$\\phi$不是显示计算，是被“规则”定义的。\n因此，INR不是一个回归问题，是一个找合法函数的问题（合法函数&#x3D;&#x3D;满足所有约束的解）\n在一堆约束$C_m(a(x), \\phi(x),  \\nabla\\phi(x), …)$中找一个函数$\\phi$，满足m条规则：有的只看$\\nabla\\phi(x)$，有的只看$\\nabla^2\\phi(x)$，有的还需要外部已知量$a(x)$。\n\n已知条件PDE&#x3D;源、边界条件\n\n$\\Omega_m$表示这个规则在哪里生效。第m条约束并不是在所有地方都要求成立。\n损失函数$L &#x3D; \\int_{\\Omega} \\sum_{m&#x3D;1}^{m}\\lvert\\Omega_m(x)\\lvert \\lvertC_m(&#96;)\\lvert,dx$\n其中$\\Omege$表示整个空间，x表示每个点。对所有的x积分，$sum_{m&#x3D;1}^{m}$表示将约束的违反程度相加。\nx在$\\Omege_m$内时表示约束算数，否则约束失效 &#x3D;&#x3D;&gt; 考虑哪些约束在这里生效\n数据集","categories":["papers","work2"],"tags":["diffusion","INR"]},{"title":"数据集","url":"/radio-map-dataset/%E6%95%B0%E6%8D%AE%E9%9B%86/","content":"实测数据集1. 暂未发布的实测数据集地址：https://www.radiomaps.org/rm/resources\ngithub仓库：https://github.com/fachu000/deep-autoencoders-cartography/tree/master\n文章：https://arxiv.org/abs/2310.11036\n2. 实测数据集  RSRPSetCell-Level RSRP Estimation With the Image-to-Image Wireless Propagation Model Based on Measured Data\ngithub仓库（代码）：https://github.com/ZhengSaber/Cell-Level-RSRP-Estimation\n数据集地址：https://ieee-dataport.org/documents/rsrpseturban-radio-map-dense-urban\n\n[real-world dataset] Yi Zheng, March 9, 2022, “RSRPSet_urban: Radio map in dense urban “, IEEE Dataport, doi:\n\n使用（论文）：\n\nPhysics-Informed Neural Networks for Path Loss Estimation by Solving Electromagnetic Integral Equations\nhttps://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=11114848\nhttps://ieeexplore.ieee.org/document/11143592\n\nGAN_train.py # Running this code to training the Pix2Pix model on RSRPSet_urban for real-world RSRP estimation.GAN_inference.py # inferencing the Pix2Pix model in RSRPSet_urban.UNet_train.py # training the UNet model on RSRPSet_urban.UNet_inference.py # inferencing the UNet model on RSRPSet_urban.## simulation dataset ==&gt; radiomapseersim_RadioGAN_train.py # training the Pix2Pix model on simulation dataset.sim_RadioGAN_inference.py # inferencing the Pix2Pix model on simulation dataset.Note: before training the model, you may need to revise the dataset path and model save path in train code.\n\n\n\n模拟数据集1. 3D地图数据集UAV-Aided Radio Map Construction Exploiting Environment Semantics\n数据集链接：https://github.com/6wj/radiomap-uav/tree/main\n使用：运行matlab文件\n2. 多地形场景、多高度、多频段、多气候数据集Generative AI on SpectrumNet: An Open Benchmark of Multiband 3D Radio Maps\n数据集说明：\n\n3 个空间维度、5 个频段、11 个地形情景和 3 个气候情景的无线电地图\n使用生成式AI的方法\n包含了11种不同地理特征的地形场景：密集城市、普通城市、乡村、郊区、山区、森林、沙漠、草原、岛屿、海洋、湖泊 \n每个区域提供三个不同高度的无线电地图：距地面1.5m、30m和200m，分别反映地面节点、建筑高度节点和空中节点的无线电地图。 为了说明全频段无线电传播，包括从150 MHz到22GHz的五个不同频率的无线电图，覆盖了无线网络的大部分工作频率。 此外，场景的变化对应于不同的气候、建筑材料和地形材料，这也会影响现实世界中的无线电传播。 因此，这些参数也被注释以用于生成每个无线电地图。\n\n文件命名格式：\n\nnpz：npz格式的文件包含特定区域的地形与建筑信息。npz文件的命名规则为“T[xx]C[x]D[xxxx] n[xx] bdtr”\n\njpg：jpg格式文件为单一频率下某区域的无线电图与地形信息的可视化图像。jpg文件命名规则为“T[xx]C[x]D[xxxx] n[xx] f[xx] visual”\n\n\n3. songyang数据集  BARTLab-UCD论文链接：https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=10424680#page=6.48\n数据集链接：https://github.com/BRATLab-UCD/Radiomap-Data\ndropbox：https://www.dropbox.com/scl/fo/kua86qnk1aukt8i4f2rma/h?rlkey=j82kiq4dgaw3l0bzbeyfvv4oi&amp;e=1&amp;dl=0\n裁剪版本：\n​\t18:\n​\t\t&#x2F;data&#x2F;home&#x2F;dcy&#x2F;SR&#x2F;change&#x2F;Supreme-master&#x2F;dataset&#x2F;train.npy\n​\t17:\n​\t\t&#x2F;data&#x2F;home&#x2F;dcy&#x2F;diffusion&#x2F;spilt_scene\n​\t\t&#x2F;data&#x2F;home&#x2F;dcy&#x2F;diffusion&#x2F;stations_v1\n​\t\t&#x2F;data&#x2F;home&#x2F;dcy&#x2F;diffusion&#x2F;buildings_v1\n4. 小规模高保真数据集  JHU-Lab论文链接：https://ieeexplore.ieee.org/abstract/document/10424680\n5. radiomapseerRadioUNet: Fast Radio Map Estimation With Convolutional Neural Networks\n数据集说明：\n​\tRadioMapSeer数据集由700张地图组成，每张地图80个发射机位置，以及相应的粗略模拟无线电地图。 粗略的模拟是使用主导路径模型（DPM）方法[26]和智能光线追踪（IRT）[53]生成的，该方法基于光线与几何形状的2种相互作用，这里称为IRT2。 此外，我们还对每个地图的前两个发射器使用具有4个相互作用的IRT （IRT4）生成了精细模拟。 这些城市地图取自OpenStreetMap[54]，分别位于安卡拉、柏林、格拉斯哥、卢布尔雅那、伦敦和特拉维夫。 我们将发射机、接收机和建筑物的高度分别设置为1.5m、1.5m和25m，这与设备对设备的场景有关（详见III-B节）。 所有模拟均使用WinProp[38]软件进行计算。 对于不同的情况（例如，校园网，蜂窝网络），应该相应地生成新的数据集。 来自数据集的一些示例无线电地图如图1所示。 所有模拟都保存为256 × 256 m2二维网格中无线电地图的密集采样。\n\n粗略模拟无线电图：利用无线网络规划软件WinProp[38]，采用DPM和IRT2生成无线电图。 每个模拟无线电图在每个像素上存储像素位置和发射机位置之间的路径损耗（以dB为单位）。为了表示数据集中的不确定性，我们考虑两种情况。 首先，使用DPM和IRT2对包括汽车在内的所有城市地图进行一组模拟。 这些模拟是对仅基于城市地图的模拟的扰动，没有汽车。 此外，我们还提供了单独的扰动城市地图数据集，其中原始数据集的每张地图中都缺少m个建筑物。 我们提供了四个这样的数据集，m &#x3D;1，… 4。\n\n更高精度的模拟：使用IRT4与相同的WinProp无线网络规划软件提供了额外的更小的更高精度模拟数据集。 在这里，我们为700张地图中的每张地图考虑了两个发射机位置。 更高精度模拟的目标是提供一种方法来测试经过模拟训练的网络是否在路径损失函数的精细表示中表现良好。 如前所述，我们在这里重申，高精度模拟可以替代现实生活中的物理现象，它有助于证明我们方案的可转移性。\n\n路径损耗尺度：将路径损耗值PL转换为0 ~ 1之间的灰度像素值（见第III-C节）。 因此，每个无线电地图都是一个大小为256 × 256的灰度级图像。\n\n\n\n参数说明：\n​\t本研究最初是由智能交通系统（ITS）背景下的设备对设备安全通信驱动的，目前基于IEEE 802.11p标准。 因此，我们认为5.9GHz频段的信号带宽W为10MHz。 我们选择发射机功率和热噪声功率谱密度分别为（PTx）dB &#x3D; 23dBm和（N0）dB &#x3D; - 174dBm&#x2F;Hz，符合IEEE 802.11p标准，并假设接收机的理想噪声系数为0dB（参见图1(e)给出了系统参数的总结）。\n","categories":["radio map dataset"],"tags":["dataset"]},{"title":"Hello World","url":"/uncategorized/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n"},{"title":"diffusion文章总结","url":"/papers/conclusion/%E6%96%87%E7%AB%A0%E6%80%BB%E7%BB%93/","content":"radiodiff不基于测量值，仅输入环境信息、发射机位置信息\n利用radiomapseer中的车辆数据集模拟动态变化\n使用条件生成的解耦扩散模型（DDM），VAE对图像进行编码，unet解码噪声\n\n3D radiodiff关注不同高度和环境影响，分别实验了有采样和无采样的情况\n高度条件的RM生成，使用DDPM\n\nWIFI-Diffusion极低采样场景问题：1%到10%\n根据环境信息、传播规律信息、收集的无线电样本生成RM\nboost block：输入 障碍物布局、无线电传播规律、收集得到的无线电样本 到self-attention UNet  &#x3D;&#x3D;&gt; 优化diffusion生成效果（采样点、预测值、临界点）\ngeneration block：DDPM加噪声，DDIM去噪（输出一组生成图像）\nelection block：使用数学无线电传播模型作为指导选择radio map\n\n\nDDPM切换为DDIM无需再训练\n\n\nResNet[16]在过去几年中被广泛应用于特征提取应用。 在WiFi-Diffusion中，我们使用它来预测res。我们通过向ResNet提供xa、xzi、处理信息（边缘检测）的拉普拉斯高斯算子（LoG）和xzi的高功率图（图8所示的示例）来学习校正因子res。\n其他方法MFFGCN关注空白区域（观测值分布不均匀）\n实现稀疏观测（10-300）和环境地图的多模态特征融合\n双编码器unet，补丁级图卷积优化网络\n粗估计 &#x3D;&#x3D;&gt;  优化\n从环境信息中获取更多的信号传播特征，要么必须基于无约束区域的经验来指导观测约束区域的重建。\n\n\n\n\nTiRE-GAN: Task-Incentivized Generative Learning for Radiomap Estimation利用无线电传播模型的物理原理和来自稀疏观测的数据统计 &#x3D;&#x3D;&gt; 任务激励生成学习模型TiREGAN\n\n引入无线电深度图来捕捉无线电传播和阴影效应的总体模式\n使用任务激励网络的物理条件cGAN，根据下游任务为无线电深度图补偿提供反馈\n\n\n图1所示。 TiRE-GAN总体结构由4部分组成：\n1)基于模型的数据预处理模块利用输入的观测信息（即建筑物图和发射机位置）生成无线电深度图，然后将四层叠加在一起作为输入； \n2)无线电地图生成模块采用cGAN发生器结构，学习并生成无线电地图预测； \n3)反馈模块由两个部分组成：cGAN鉴别器和任务激励网络。 两个模块都产生一个损失项作为反馈，以改进生成器； \n4)为培训指导提供额外损失期的下游任务。\nRadioGAT: A Joint Model-Based and Data-Driven Framework for Multi-Band Radiomap Reconstruction via Graph Attention NetworksOpenStreetMap\n关注 空间、时间、频带稀疏样本，多频段RM重建\n图形注意力网络（GAT）\n不依赖 模拟数据 或 完整的结构化地面事实 &#x3D;&#x3D;&gt; 使用masked GAT，不基于完整的地面数据\n利用无线电传播模型来捕获相关性 &#x3D;&#x3D;&gt; radio depth map\n：1)基于模型的空间-谱相关编码； 2)数据驱动的跨带泛化\n基于频率的射频深度图 &#x3D;&#x3D;&gt; 不同频率有不同的深度图，用于构造邻接矩阵\n\n设计编码策略，将稀疏的多波段数据转换为图形结构，该编码策略利用无线电传播模型来捕获数据中固有的空间-频谱相关性。\n集中在不同区域的空间相关性上。 MB-RMR方法不仅可以利用带内空间相关性，还可以利用相同空间坐标下的带间相关性。\n\n带内空间相关性：同一“频带”或者“通道”里的数据，不同空间位置之间可能存在规律性\n带间相关性：不同“频带”或者“通道”在同一空间位置上也可能相关\n带 &#x3D;&#x3D;&gt; 频带\n\n使用一个频带去预测别的频带的图像\n\n请注意，基于图的无线地图估计可以被表述为半监督学习[38]，其中RSS可以被视为每个节点的注释（标签 label），而环境和几何信息可以被视为特征。 \n标注节点和未标注节点都要参与图的学习，图的边是根据特征构造的。 以E(k) b的构建为重点，介绍了现有的基于邻接性、环境信息和发射机信息的三种编码方法，并在此基础上提出了基于模型的相关编码方法。\n\n基于图的无线地图估计\n\n\n你可以把“无线地图”理解为一个二维&#x2F;三维空间里信号强度的分布图。\n“基于图”意味着我们把空间中的接收点或者位置抽象成图里的节点，节点之间有边。\n\n\n半监督学习\n\n\n有些节点有测量值（RSS，Received Signal Strength，信号强度）——这就是“标注节点”。\n有些节点没有测量值，只能用周围信息去推断——这就是“未标注节点”。\n半监督学习就是同时利用“有标注”和“无标注”数据进行学习。\n\n\nRSS是节点的注释，环境和几何信息是特征\n\n\n节点的“标签”（annotation）就是信号强度RSS。\n节点的“特征”是与环境和位置相关的信息，比如建筑物位置、障碍物、发射机位置等等。\n\n无标注的节点参与学习的方法：\n\n标签传播（Label Propagation）：假设节点A有RSS标签，节点B没有。\n\n节点B通过图上的边“看邻居”，用邻居节点的标签信息来更新自己的估计值。\n\n半监督图神经网络（GNN）\n\nGNN会把每个节点的特征（位置、环境信息、发射机信息）和邻居节点的信息混合，生成节点表示。训练时只用标注节点的损失（例如RSS预测误差）来反向传播，但因为网络是全图的，无标注节点的表示也会被更新。\n换句话说，无标注节点参与“信息传递”，帮助模型学习更平滑、符合图结构的表示。\n&#x3D;&#x3D;&gt; 无标注节点不参与反向传播，最后（测试）是预测无标签节点的值。其余时刻均只关注有标签节点的loss\nGAT VS GNN：\n\n传统GNN（比如GCN）在更新节点表示时，会把邻居节点的特征平均或加权平均后传递给自己。\nGAT的创新点：不是简单平均，而是用注意力机制给不同邻居分配不同权重。\n\n换句话说，它会自己学：“哪个邻居的信息对我最重要，我就给它更高的权重。”\n\n","categories":["papers","conclusion"],"tags":["notes","conclusion"]},{"title":"深度学习相关笔记","url":"/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9B%B8%E5%85%B3%E7%AC%94%E8%AE%B0/","content":"优化器Adam : Adaptive Moment Estimation特点：\n\n自适应学习率：每个参数都有自己的学习率\n带偏差修正：初期收敛更稳定\n\n缺点：正则化效果不好，L2 weight decay 实际上是“对梯度加衰减”，不是真正正则化参数\nAdamW : Adam + 正确的 Weight DecayAdam 里 L2 weight decay 是和梯度混合的 → 实际上是“修改梯度”，容易影响动量\n&#x3D;&#x3D;&gt; AdamW 把 weight decay 独立应用在参数更新上\n优点：\n\n正则化更纯粹 → 提高泛化能力\n训练更稳定 → 常用于 Transformer 和大模型\n\n💡 总结一句话：AdamW 就是带正确 L2 正则的 Adam\nLAMB : Layer-wise Adaptive Moments optimizer for Batch training &#x3D;&#x3D;&gt; 为大 batch &#x2F; 大模型训练设计的 AdamW 变体\nLayer-wise 自适应缩放: 每一层的参数更新 \\Delta \\theta 按比例缩放\n\n&#x3D;&#x3D;&gt; 解决大 batch 时学习率不均衡的问题\n\n保留 AdamW 的优点：偏差修正 + weight decay 独立\n\n特点：\n\n适合大 batch 训练（比如 BERT 或 GPT 大模型训练）\n学习率可以更大，收敛稳定\n对小模型、小 batch 不一定比 AdamW 有优势\n\nAdam&#x2F;SGD 的问题：在大 batch 训练时，直接放大学习率会导致震荡甚至不收敛。\nLAMB 的改进：\n\n它不仅像 Adam 一样对梯度做自适应缩放，还对 参数本身的范数 做归一化。\n换句话说，它确保“更新步长”和“参数大小”是成比例的，避免某些参数更新过大&#x2F;过小。\n\n这让 大 batch 训练时依然能稳定收敛，并且允许用更大学习率，加速训练\n总结：\n优化器会动态调整 步长（学习率）：\n\nSGD：固定学习率，单纯往梯度方向走。\nAdam：用一阶（均值）和二阶（方差）矩估计，对每个参数自适应调节学习率（大梯度 → 缩小步长，小梯度 → 放大学习率）。\nAdamW：在 Adam 基础上修正 weight decay 逻辑，让正则化效果更纯粹。\n学习率调度器（Scheduler）：额外定义随训练过程变化的学习率（warmup、cosine decay 等）。\n\n正则化定义：在模型训练时，加上一个约束，让它不要随意拟合训练数据，从而提高泛化能力。\n\n没正则化 → 模型可能过拟合 → 在训练集上很好，但测试集上表现差\n正则化 → 给模型“穿上枷锁”，让它学到更平滑、更简单的规律\n\n数学解释：在原本的损失函数上添加一个惩罚项\nL2 正则（Ridge &#x2F; Weight Decay）公式：\n\n特点：\n\n惩罚参数的平方 → 大参数会被压小\n对所有参数平滑地缩小 → 模型参数分布更均匀\n在优化器里对应 weight decay\n\n直观理解：\n\n想象每个参数是一根弹簧，L2 惩罚让弹簧尽量不要伸得太长\n模型不敢过度依赖某个特征 → 泛化能力强\n\n为什么大参数被压缩，模型不依赖单个特征？\n\n假设某个特征的权重大 → 它在预测中起决定性作用\nL2 正则会把所有权重都缩小 → 大权重被拉小 → 模型不能只依赖它\n\n结果：\n\n模型分布在更多参数上 → 特征利用更均衡\n泛化能力提升，不会因为训练集某个特征异常而过拟合\n\nL1 正则（Lasso）公式：\n\n特点：\n\n惩罚参数绝对值\n会产生 稀疏解 → 很多参数被压到 0\n可以做特征选择：保留重要特征，忽略不重要特征\n\n直观理解：\n\n想象把每根参数的长度直接砍掉一部分 → 不重要的直接砍成 0\n\n特点：\n\n梯度在 0 附近不连续 → 很容易把小参数直接压为 0\n重要参数保留 → 0 的参数对应“不重要”特征被忽略\n\n所以：\n\n稀疏解 &#x3D; 自动选择特征\n模型只保留对预测贡献大的特征\n\n补充：参数 梯度 权重 学习率\n权重（weight）：就是模型里的参数。\n\n模型学习的核心目标就是找到一组最优权重，使得预测结果和真实标签尽可能接近。\n\n梯度（gradient）：损失函数对权重的导数（往哪走）\n\n它告诉我们：如果我稍微调整某个权重，损失会往哪个方向增大&#x2F;减小。\n所以梯度本质上是更新权重的方向指引器，而不是权重本身。\n\n学习率：控制“步长”，在梯度更新和正则化中都起作用（走的步长）\n\n控制梯度下降和正则化压缩的步长\n学习率衰减：随训练逐步减小 \\eta\n\n初期大步 → 快速下降\n\n后期小步 → 收敛稳定\n\n作用于梯度和正则化一起，避免收敛振荡\n\n\n梯度下降：根据梯度调整参数\n正则化：在损失函数中加上了一项，求导之后权重更新中多了一项正则项对梯度的贡献\nweight decay：不从梯度计算，直接对参数进行衰减 &#x3D;&#x3D;&gt; 避免和动量&#x2F;自适应梯度混合干扰，数值表现更稳定（这就是 AdamW 的核心改进 –&gt; 把两者区分开）。\n优化器中的weight decayWeight Decay 就是 L2 正则化在优化器里的实现方式\n传统做法：在更新参数的时候直接加上对参数的惩罚\n\n\n优化器中的正则化通常只有 L2（Weight Decay）。L1 可以自己手动加到损失函数里，但主流优化器（AdamW、LAMB、SGD）默认只支持 L2&#x2F;Weight Decay\n有些场景会混合使用（比如 Elastic Net &#x3D; L1 + L2）\n权重（参数）更新权重（参数）更新是 梯度 + 正则化 + 优化器机制 共同作用的结果：\n\n梯度：来自损失函数 \\mathcal{L}，告诉你该往哪走、走多远（方向 + 大小）。\n正则化：相当于在损失函数里加“惩罚项”，限制参数规模或稀疏化（L1&#x2F;L2），避免模型太复杂。\n优化器：在用梯度更新参数时，额外引入技巧（动量、学习率调度、权重衰减等），让训练更快、更稳。\n\n你可以把它想成：梯度是指路灯，正则化是修路时加的护栏，优化器是导航软件，三者一起决定你怎么走到终点。\n随机种子在深度学习里很多东西都带“随机性”：\n\n数据打乱（shuffle&#x3D;True 时，每个 epoch 样本顺序会随机变化）\n参数初始化（模型的权重通常用随机数初始化）\nDropout（每次会随机丢掉不同的神经元）\n数据增强（随机裁剪、翻转等）\n\n如果不设种子，每次运行都会不一样，结果可能波动很大。\n&#x3D;&#x3D;&gt; 设定随机种子 &#x3D; 固定“随机数生成器”的起点，保证你下次跑出来的结果和这次一样（复现实验）。\n","categories":["基础知识","深度学习"],"tags":["notes"]},{"title":"\"Frequency Domain-Based Diffusion Model for Unpaired Image\" Dehazing","url":"/papers/work2/papers/work2/postpapers-work2-Frequency-Domain-Based-Diffusion-Model-for-Unpaired-Image-Dehazing/","content":"基于频域的非配对图像去雾扩散模型\n图像去雾：从被雾霾遮挡的图像中恢复清晰图像。传统方法多依赖物理模型（如大气散射模型）或配对训练数据（清晰图像 + 对应雾图像）。\n\n输入：雾图像（Hazy Image）\n输出：去雾图像（Dehazed&#x2F;Clear Image）\n目标：恢复清晰图像的颜色、纹理和结构，同时去除雾霾造成的衰减和颜色偏移。在非配对设置下，你 不需要每个雾图像都对应一个清晰图像，训练数据更灵活：\n数据集只提供一组雾图像和一组清晰图像，但没有逐一对应关系。\n通常使用 生成对抗网络（GAN） 或 对比学习（Contrastive Learning） 来学习域间映射：\n雾域 → 清晰域\n保持图像内容不变，但去除雾霾特征“忽略了频域的雾霾特性（雾霾相关的退化主要表现在幅度谱上）”，这就涉及 图像频域分析：\n\n\n雾霾对图像主要表现为 低频衰减、高频模糊：\n幅度谱的低频部分（整体亮度和大结构）会被衰减或偏移\n高频部分（纹理、边缘）会模糊基于对比学习的主流方法如果只在 空间域（RGB像素或特征图） 对比，可能会 保留雾霾残余 或破坏纹理。\n\n\n\n\nabstruct非配对图像去雾（Unpaired image dehazing）因其在模型训练过程中对数据需求的灵活性而受到越来越多的关注。基于对比学习的主流方法不仅引入了与雾霾无关的内容信息，而且忽略了频域的雾霾特性（即雾霾相关的退化主要表现在幅度谱上）。为了解决这些问题，我们提出了一种新的基于频域的扩散模型，称为FrDiff，以充分利用非成对清晰数据中的有益知识。 特别是，受扩散模型强大的生成能力的启发，我们从频域重建的角度来解决去雾任务，并执行扩散模型以产生与清晰图像分布一致的幅度谱。为了实现这一目标，我们提出了一种振幅残差编码器（Amplitude Residual Encoder， ARE）来提取振幅残差，有效地补偿了模糊域到清晰域的振幅间隙，并为dm（diffusion model）的训练提供了监督。此外，我们提出了一种相位校正模块（PCM），通过使用简单的注意机制进一步细化除雾过程中的相位谱来消除伪影。实验结果表明，我们的FrDiff在合成和真实数据集上都优于其他最先进的方法。\nintro雾霾是一种经常发生的大气现象，是由粉尘、烟雾等气溶胶粒子的散射效应引起的。 它通常导致场景辐射衰减，产生严重的视觉内容退化[19]。 图像去雾可以用于提高后续高级视觉任务的性能[31,46]。为了消除雾霾，传统方法是基于大气散射模型[38]或观测值手动设计图像先验[3,4,18,19,68]。 然而，这些手工制作的先验很难准确地模拟雾霾的内在特征，而且往往缺乏鲁棒性和可靠性。 最近基于深度学习的方法主要集中在使用合成的成对模糊-清晰数据开发监督模型[13,34,42,42,64]。其中，亮度对比（如雾霾）表现在幅值谱上的发现[39,48]显示了通过频域去除雾霾的巨大潜力[30,41,62]（如图2(a)所示，详细的统计分析请参见附录）。 然而，合成雾霾与真实雾霾之间存在较大的域差距，限制了其在现实场景下的泛化能力[60]。 此外，获取成对的模糊清晰数据非常昂贵且耗时。最近，扩散模型（DMs）在图像恢复方面表现出了令人印象深刻的性能[10,24,32,36,59,61]，这促使我们研究它们在雾霾去除方面的有效性。\n\n图2。 (a)雾霾在频域的退化特性说明。 雾霾的降解可以通过振幅谱的交换进行转移。 \n(b)类对比学习方法构建正、负样本对，最大限度地提高干净图像和模糊图像之间的互信息。 \n(c)我们的FrDiff在训练过程中从未配对的数据中学习清晰图像的振幅谱，并在推理过程中重建它们。\n然而，将这些模型应用于非配对图像去雾存在一些挑战：\n1)dm对亮度对比度敏感。 直接利用DMs生成清晰图像的方法[24,36]往往会导致不可预测的伪影和色差，同时也会产生大量的计算成本[61,63]。 \n2)其他使用dm生成潜在表示的方法[10,32,59]只能从高质量的成对数据中学习，这限制了它们在非成对设置中的应用。 因此，探索利用DMs进行非配对图像恢复的有效方法仍然是一个重大挑战。\n本文针对雾霾的频域特征，提出了一种新的非配对图像去雾（FrDiff）扩散模型。 FrDiff的核心思想是利用DM学习从未配对的数据中重建清晰图像的振幅，如图2(c)所示。 \n具体来说，我们按照前面的实践[10,59]将FrDiff的训练过程分为两个步骤，如图3所示。 \n\n在第一步中，我们引入了振幅残差编码器（Amplitude Residual Encoder， ARE），它提取振幅残差来解决模糊图像和清晰图像之间振幅分布的差距，而不会干扰与雾无关的特征。 此外，我们在除雾网络中加入相位校正模块（PCM）以进一步增强相位谱。 我们对除雾网络进行了优化，以有效地利用振幅残差进行除雾。 \n在第二步中，我们利用从ARE获得的幅度残差作为地面真值，并训练DM从高斯噪声中重建这些残差以去除雾霾。 在推理过程中，DM以高斯噪声为输入，以模糊图像的幅值谱为条件重构幅值残差。 与重建包含光照和纹理结构的图像相比，重建只包含光照信息的幅值残差所需的迭代次数更少[39,48]。\n我们提出了一种新的基于频域的非配对图像去雾（FrDiff）扩散模型，这是第一个将DM集成到非配对恢复任务中的研究。\n\nFrDiff通过学习非配对数据的振幅重建来增强雾霾去除能力，为其他非配对恢复任务提供了灵感。\n\n\n我们提出了一个振幅残差编码器（ARE），它产生振幅残差，以弥合模糊和清晰域之间的差距，而不添加额外的参数，为DM训练提供监督。\n我们提出了一种相位校正模块（PCM），旨在通过使用注意机制改进相位谱来消除不需要的伪像。\n大量实验表明，FrDiff以更少的参数和FLOPs优于现有的SOTA方法。\n\n\n\n空间域vs频域\n\n空间域：平时可见的图像，由像素值矩阵表示，每个像素值直接表示亮度和颜色\n频域：将图像从像素表示转换成频域表示。频率表示图像中亮度变化的快慢\n\n低频：亮度变化慢，反映大块区域、整体结构、平滑色彩\n高频：亮度变化快，反映纹理、边缘、细节\n\n\n像素表示转换成频域表示：一般由二维傅立叶变换2D-FFT变换实现\n\n由振幅（幅度谱）和相位组成\n\n图像去雾任务\n\n雾霾主要降低了高频能量：图像边缘、细节模糊。但相位变化小（图像结构位置基本没变） \n​    &#x3D;&#x3D;&gt; 有大量“真实图像”的相近信息\n从频域重建：分析幅度谱，调整高低频分布，增强模糊的高频。然后将修改后的频域FFT变回空间域，得到更清晰的图像。\n\n分别输入实部和虚部（幅度谱和相位信息）\n\n图像实虚部 &#x3D;&#x3D;&gt; 学习和gt之间的残差                   超分任务\n物理意义上的电场实部虚部 &#x3D;&#x3D;&gt; loss函数约束\n\n根据稀疏观测计算\n根据发射机位置计算 Physics-Informed Neural Networks for Path Loss Estimation by Solving Electromagnetic Integral Equations\n\n作为不同（4个）channel输入\n\n","categories":["papers","work2"],"tags":["diffusion","cv","frequency"]}]